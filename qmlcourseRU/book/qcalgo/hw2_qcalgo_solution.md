(hw2_solution)=

# Задание 2. Квантовые алгоритмы. Решение

Автор – Сергей Ширкин. [Ссылка на тест](https://ods.ai/tracks/qmlcourse/blocks/3383edce-0c64-4fbc-a498-1c5f4c2a381e)

_Правильные варианты ответа помечены значком [x]._

**1\. Для функции $f$, используемой в задаче Саймона, известно, что $f(a) = f(b)$ и $a \neq b$. Чему равно $a$, если $b = 11011$, а также уже известна скрытая последовательность $s$, равная $00101$?**

- $00100$
- [x] $11110$
- $00000$
- $11101$

**Решение:**

Применим поразрядно операцию XOR:

$a = b \oplus s = 11011 \oplus 00101 = 11110$


**2\. Имеется база данных, состоящая из 32 записей. Требуется найти в этой базе одну запись, используя алгоритм Гровера. Сколько итераций нужно сделать, и какая при этом будет вероятность получить неправильную запись?**

- 1 итерация, ошибка $0\%$
- 2 итерации, ошибка $5.5\%$
- 3 итерации, ошибка $3.9\%$
- [x] 4 итерации, ошибка $0.08\%$

**Решение:**

Идентификаторы для $32$ записей в базе данных можно закодировать с помощью 5 кубитов ($32 = 2^5$). После того как кубиты приведены в состояние суперпозиции, а также одно из базисных состояний, соответствующее искомому идентификатору, помечено минусом, синус начального угла (обозначим его как $\theta$) между гиперплоскостью всех состояний, кроме искомого, и вектором искомого состояния равен амплитуде искомого состояния: $\sin \theta = \frac{1}{4\sqrt{2}}$. Этому значению соответствует угол: $\arcsin{\frac{1}{4\sqrt{2}}} \approx 10.182^{\circ}$.

Итоговый угол после нужного числа итераций $t$ должен быть максимально приближен к $90^{\circ}$. Исходя из этого и формулы итогового угла $(2t + 1) \theta$, находим $t = 4$. Итоговый угол при этом составит $(2t + 1) \theta \approx 9 \cdot 10.182^{\circ} \approx 91.638^{\circ}$. Итоговая амплитуда искомого состояния равна $\sin ((2t + 1) \theta)$. Вероятность того, что после измерения будет получено искомое базисное состояние, равна квадрату модуля амплитуды, что составляет около $99.92\%$, откуда легко найти ошибку, равную примерно $0.08\%$.

**3\. Алиса отправляет Бобу один бит информации, закодированной в состояниях кубита $|+\rangle$ и $|-\rangle$, используя схему квантовой телепортации. После того, как она производит измерение двух кубитов, находящихся на ее стороне, в вычислительном базисе, она связывается с Бобом по классическому каналу связи и сообщает ему результат измерения. Из-за помех связи Бобу удается услышать только результат измерения верхнего кубита схемы. Какова вероятность того, что Боб сможет узнать переданную ему информацию, измерив свой кубит в базисе Адамара?**

- $25\%$
- $50\%$
- $75\%$
- [x] $100\%$

**Решение:**

Так как Алисе нужно переслать Бобу только один бит информации, ей достаточно передать либо состояние $|+\rangle$, либо $|-\rangle$.
Рассмотрим обе ситуации по отдельности.

1\. Алиса передает состояние $|+\rangle$ (его также можно обозначить как $\frac{1}{\sqrt{2}}|0\rangle + \frac{1}{\sqrt{2}}|1\rangle$). После того как она производит измерение своих кубитов, на стороне Боба кубит принимает одно из 3-х состояний:

1\) с вероятностью $50\%$ это состояние $\frac{1}{\sqrt{2}}|0\rangle + \frac{1}{\sqrt{2}}|1\rangle$ (когда верхний кубит Алисы равен $0$, а средний равен либо $0$, либо $1$);

2\) $25\%$ -- состояние $\frac{1}{\sqrt{2}}|0\rangle - \frac{1}{\sqrt{2}}|1\rangle$ (верхний кубит равен $1$, средний кубит равен $0$);

3\) $25\%$ -- состояние $-\frac{1}{\sqrt{2}}|0\rangle + \frac{1}{\sqrt{2}}|1\rangle$ (верхний кубит равен $1$, средний кубит равен $1$).

После этого Алиса сообщает результаты измерения верхнего и среднего кубита, находящихся на ее стороне. Бобу удается услышать только результат измерения верхнего кубита. Если этот результат равен $0$, то это первый случай. Ничего делать при этом не нужно, у Боба уже находится состояние $|+\rangle$, которое при измерении в базисе Адамара (соответствующем оператору Паули $X$), даст результат $0$. Во втором и третьем случае, когда верхний кубит находится в состоянии $1$, нужно применить оператор $Z$ к кубиту Боба, будет получено состояние $|+\rangle$ или $-|+\rangle$ соответственно, которое при измерении в базисе Адамара также даст результат $0$.

2\. Алиса передает состояние $|-\rangle$ (можно обозначить как $\frac{1}{\sqrt{2}}|0\rangle - \frac{1}{\sqrt{2}}|1\rangle$). Когда она производит измерение своих кубитов, на стороне Боба кубит принимает одно из 3-х состояний:

1\) с вероятностью $25\%$ это состояние $\frac{1}{\sqrt{2}}|0\rangle - \frac{1}{\sqrt{2}}|1\rangle$ (когда верхний кубит Алисы равен $0$, а средний также равен $0$);

2\) $25\%$ -- состояние $-\frac{1}{\sqrt{2}}|0\rangle + \frac{1}{\sqrt{2}}|1\rangle$ (верхний кубит равен $0$, средний кубит равен $1$);

3\) $50\%$ -- состояние $\frac{1}{\sqrt{2}}|0\rangle + \frac{1}{\sqrt{2}}|1\rangle$ (когда верхний кубит Алисы равен $1$, а средний равен $0$ или $1$).

После этого Алиса сообщает результаты измерений. Если результат измерения верхнего равен $0$, то это первый или второй случай. Ничего делать не нужно, у Боба уже находится состояние $|-\rangle$ (первый случай) или $-|-\rangle$ (второй случай), которое при измерении в базисе Адамара (соответствующем оператору Паули $X$), даст результат $1$. В третьем случае, когда верхний кубит находится в состоянии $1$, нужно применить оператор $Z$ к кубиту Боба, будет получено состояние $|-\rangle$, которое при измерении в базисе Адамара также даст результат $1$.

Таким образом, вероятность правильно получить переданную информацию равна $100\%$, если не учитывать другие явления (например, декогеренцию).


**4\. Кот Шредингера сбежал из лаборатории, перевернув при этом устройство, реализующее алгоритм Дойча. В результате этого происшествия устройство повредилось, так что вместо одного из операторов Адамара начала работать другая однокубитная операция. Причем алгоритм продолжил безошибочно определять константные функции, но стал допускать ошибки при распознавании сбалансированных функций (в $14.6\%$ случаев). Какой из операторов Адамара повредился, и какой новый оператор стал работать на его месте?**

- Повредился первый оператор Адамара для верхнего кубита
- Повредился второй оператор Адамара для верхнего кубита
- [x] Повредился оператор Адамара для нижнего кубита
- [x] Новый оператор $RY(\frac{\pi}{4})$
- Новый оператор $RY(\frac{\pi}{2})$
- [x] Новый оператор $RY(\frac{3\pi}{4})$
- Новый оператор $RY(\frac{4\pi}{3})$

**Решение:**

Если вместо оператора Адамара на верхнем кубите до или после оракула поместить один из предложенных операторов $RY(\theta)$ то верхний кубит перед измерением будет находиться в состоянии суперпозиции (исключение - оператор $RY(\frac{\pi}{2})$, но в вариантах ответа его нет), так что ошибки могут появиться не только при обнаружении сбалансированной функции (реализуется в оракуле с использованием запутывания верхнего и нижнего кубита), но и при обнаружении константной функции, когда состояние нижнего кубита не зависит от состояния верхнего.

Проверим один из предложенных операторов $RY(\frac{\pi}{4})$: поместим его вместо оператора Адамара на нижнем кубите. Тогда перед применением оракула система кубитов будет находиться в состоянии:

$|\psi\rangle = \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle) \otimes RY(\frac{\pi}{4})|1\rangle = \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle)(-\sin\frac{\pi}{8}|0\rangle + \cos\frac{\pi}{8}|1\rangle)$

После действия оракула состояние примет вид:

```{math}
\begin{aligned}

|\psi\rangle =
	& \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle)(-\sin\frac{\pi}{8}|0 \oplus f(|x\rangle)\rangle + \cos\frac{\pi}{8}|1 \oplus f(|x\rangle)\rangle) = \\
	& \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}|0\rangle|0 \oplus f(|0\rangle)\rangle + \cos\frac{\pi}{8}|0\rangle|1 \oplus f(|0\rangle)\rangle - \\
	& \sin\frac{\pi}{8}|1\rangle|0 \oplus f(|1\rangle)\rangle + \cos\frac{\pi}{8}|1\rangle|1 \oplus f(|1\rangle)\rangle)

\end{aligned}
```

**Для $f(x) = 0$:**

$|\psi\rangle = \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}|00\rangle + \cos\frac{\pi}{8}|01\rangle -\sin\frac{\pi}{8}|10\rangle + \cos\frac{\pi}{8}|11\rangle)\rangle) = \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}(|0\ + |1\rangle)|0\rangle + \cos\frac{\pi}{8}(|0\rangle + 1\rangle)|1\rangle)$

После применения оператора Адамара к верхнему кубиту:

$|\psi\rangle = -\sin\frac{\pi}{8}|00\rangle + \cos\frac{\pi}{8}|01\rangle$

После измерения верхнего кубита возможно получить только значение $0$.

**Для $f(x) = 1$:**

$|\psi\rangle = \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}|01\rangle + \cos\frac{\pi}{8}|00\rangle -\sin\frac{\pi}{8}|11\rangle + \cos\frac{\pi}{8}|10\rangle)\rangle) = \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}(|0\rangle + |1\rangle)|1\rangle +\cos\frac{\pi}{8}(|0\rangle + |1\rangle)|0\rangle$

После применения оператора Адамара к верхнему кубиту:

$|\psi\rangle = -\sin\frac{\pi}{8}|01\rangle + \cos\frac{\pi}{8}|00\rangle$

После измерения верхнего кубита так же, как и в предыдущем примере, возможно получить только значение $0$. Видим, что при наличии константной функции ее обнаружение происходит без ошибок.

**Для $f(x) = x$:**

$|\psi\rangle = \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}|00\rangle + \cos\frac{\pi}{8}|01\rangle -\sin\frac{\pi}{8}|11\rangle + \cos\frac{\pi}{8}|10\rangle)\rangle) = \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}(|00\rangle + |11\rangle) + \cos\frac{\pi}{8}(|01\rangle + |10\rangle))$

После применения оператора Адамара к верхнему кубиту:

```{math}
\begin{aligned}

|\psi\rangle =
	& \frac{1}{2}(-\sin\frac{\pi}{8}((|0\rangle + |1\rangle)|0\rangle + (|0\rangle - |1\rangle)|1\rangle) + \cos\frac{\pi}{8}((|0\rangle + |1\rangle)|1\rangle + (|0\rangle - |1\rangle)|0\rangle) = \\
	& \frac{1}{2}(-\sin\frac{\pi}{8}(|00\rangle + |10\rangle + |01\rangle - |11\rangle) + \cos\frac{\pi}{8}(|01\rangle + |11\rangle + |00\rangle - |10\rangle))  = \\
	& \frac{1}{2}(-\sin\frac{\pi}{8}(|0\rangle(|0\rangle + |1\rangle) + |1\rangle(|0\rangle - |1\rangle)) + \cos\frac{\pi}{8}(|0\rangle(|1\rangle + |0\rangle) + |1\rangle(|1\rangle - |0\rangle))) = \\
	&  \frac{1}{2}((\cos\frac{\pi}{8} - \sin\frac{\pi}{8})|0\rangle(|0\rangle + |1\rangle) - (\cos\frac{\pi}{8} + \sin\frac{\pi}{8})|1\rangle(|0\rangle - |1\rangle))

\end{aligned}
```

Посчитаем вероятность случаев, когда при измерении этой функции будет получено значение $0$:

$2 \cdot (\frac{1}{2}(\cos \frac{\pi}{8} - \sin \frac{\pi}{8}))^2 \approx 0.1464$

Таким образом, при измерении функции $f(x) = x$ примерно в $14.64\%$ случаев будет получено ошибочное значение.

**Для $f(x) = \bar{x}$:**

$|\psi\rangle = \frac{1}{\sqrt{2}}(-\sin\frac{\pi}{8}|01\rangle + \cos\frac{\pi}{8}|00\rangle -\sin\frac{\pi}{8}|10\rangle + \cos\frac{\pi}{8}|
11\rangle)$

После применения оператора Адамара к верхнему кубиту:


```{math}
\begin{aligned}

|\psi\rangle =
	& \frac{1}{2}(-\sin\frac{\pi}{8}((|0\rangle + |1\rangle)|1\rangle + (|0\rangle - |1\rangle)|0\rangle) + \cos\frac{\pi}{8}((|0\rangle + |1\rangle)|0\rangle + (|0\rangle - |1\rangle)|1\rangle) = \\
	& \frac{1}{2}(-\sin\frac{\pi}{8}(|01\rangle + |11\rangle + |00\rangle - |10\rangle) + \cos\frac{\pi}{8}(|00\rangle + |10\rangle + |01\rangle - |11\rangle))  = \\
	& \frac{1}{2}(-\sin\frac{\pi}{8}(|0\rangle(|1\rangle + |0\rangle) + |1\rangle(|1\rangle - |0\rangle)) + \cos\frac{\pi}{8}(|0\rangle(|0\rangle + |1\rangle) + |1\rangle(|0\rangle - |1\rangle))) = \\
	& \frac{1}{2}((\cos\frac{\pi}{8} - \sin\frac{\pi}{8})|0\rangle(|0\rangle + |1\rangle) + (\cos\frac{\pi}{8} + \sin\frac{\pi}{8})|1\rangle(|0\rangle - |1\rangle))

\end{aligned}
```

Посчитаем вероятность случаев, когда при измерении этой функции будет получено значение $0$:

$2 \cdot (\frac{1}{2}(\cos \frac{\pi}{8} - \sin \frac{\pi}{8}))^2 \approx 0.1464$

Таким образом, при измерении функции $f(x) = \bar{x}$ примерно в $14.64\%$ случаев будет получено ошибочное значение. Для функции $f(x) = x$ было получено такое же значение ошибки, следовательно, при измерении сбалансированных функций будет наблюдаться ошибка около $14.64\%$.

Аналогичное решение с таким же значением ошибки -- для оператора $RY(\frac{3\pi}{4})$.
